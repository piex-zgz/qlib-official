# My Quant Project Configuration
# 使用akshare获取数据，qlib进行训练和回测

# 数据配置
data:
  source: akshare
  save_dir: D:/Quant-qlib-official/data/source
  normalize_dir: D:/Quant-qlib-official/data/normalize
  qlib_dir: D:/Quant-qlib-official/data/qlib_data
  start_date: 20080101
  end_date: 20250101

# 训练配置
train:
  # 模型选择: LightGBM, XGBoost, catboost_model, pytorch_gru
  model: LightGBM

  # 可选: 自定义模型配置 (覆盖预设模板)
  # model_config:
  #   class: LGBModel
  #   module_path: qlib.contrib.model.gbdt
  #   kwargs:
  #     loss: mse
  #     colsample_bytree: 0.8879
  #     learning_rate: 0.02
  #     subsample: 0.8789
  #     lambda_l1: 205.6999
  #     lambda_l2: 580.9768
  #     max_depth: 8
  #     num_leaves: 210
  #     num_threads: 20

  # LSTM/GRU 专用配置
  # step_len: 20

  instruments: csi300
  segments:
    train: [2008-01-01, 2014-12-31]
    valid: [2015-01-01, 2016-12-31]
    test: [2017-01-01, 2024-12-31]  # 修改为实际数据的最后日期

# 回测配置
backtest:
  start_time: 2017-01-01
  end_time: 2024-12-30  # 需要提前一天，因为代码会访问 end_time 的下一天
  account: 100000000
  benchmark: SH000300
  topk: 50
  n_drop: 5
  exchange_kwargs:
    limit_threshold: 0.095
    deal_price: close
    open_cost: 0.0005
    close_cost: 0.0015
    min_cost: 5

# 实盘模拟持续回测配置
live_backtest:
  enabled: true
  download_data: true          # 是否每天下载最新数据
  retrain_frequency: "weekly"  # 重新训练频率: daily/weekly/monthly/never
  initial_cash: 100000000      # 初始资金
  topk: 50                     # 每次选择的股票数量
  n_drop: 5                    # 调仓时换出股票数量
  state_file: .live_backtest_state.json  # 状态文件路径

# Online Serving 配置 (基于 qlib OnlineManager)
online_serving:
  enabled: true
  rolling_step: 252            # 滚动训练步长（交易日），约1年
  retrain_day: "monday"        # 重新训练日: monday/tuesday/wednesday/thursday/friday
  initial_cash: 100000000      # 初始资金
  topk: 50                     # TopkDropout 策略参数
  n_drop: 5                    # 调仓时换出股票数量
  benchmark: SH000300          # 基准指数
  state_file: .online_serving_state.json  # 状态文件路径
